# æŸé«˜æ ¡ç–«æƒ…é˜²æ§è‡ªåŠ¨ç­¾åˆ°æ‰“å¡

## ä½¿ç”¨

å¯ä»¥é…åˆ [é˜¿é‡Œäº‘æ•ˆ](https://devops.aliyun.com/) æˆ–è€… [coding](https://coding.net/)ï¼Œåªè¦æ˜¯è·‘åœ¨å›½å†…æœåŠ¡å™¨éƒ½å¯ä»¥

**ä½¿ç”¨æ­¥éª¤**

1. å…ˆæ³¨å†Œé˜¿é‡Œäº‘è´¦å·
2. ç„¶åè¿›å…¥[äº‘æ•ˆå¾—devops](https://devops.console.aliyun.com/organizations)
   - åœ¨è¿™é‡Œç•Œé¢ä¸­ç‚¹å‡»åˆ›å»ºä¼ä¸š
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mbadobmlj31hc0swna5.jpg)
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mbbfhu1qj30mu0fpabl.jpg)
   - ç„¶åç‚¹å‡»ç«‹å³ä½“éªŒï¼Œè¿›å…¥å°±å¥½
   - æ¥ç€å°±ä¼šè¿›å…¥å¦‚ä¸‹ç•Œé¢
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mbcmdigsj31hc0swtni.jpg)
3. è¿›å…¥ `ä»£ç ç®¡ç†`ã€‚åœ¨å³ä¸Šè§’æ‰¾åˆ° `å¯¼å…¥ä»£ç åº“`
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mbdpyvlij31hc0swajs.jpg)
   - æŒ‰ç…§ä¸‹é¢ç¤ºä¾‹è¿›è¡Œå¡«å†™ï¼Œä»“åº“åœ°å€æ˜¯ï¼š`https://github.com/james-curtis/hnie-auto-sign.git`
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mbehv5e7j30lf0mytbr.jpg)
4. æµæ°´çº¿è®¾ç½®
   - ç‚¹å‡»å·¦ä¾§çš„ `æµæ°´çº¿`
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mbfujlvyj309s0g0wfo.jpg)
   - è·³è½¬é¡µé¢ä¹‹åï¼Œç‚¹å‡»å³ä¸Šè§’çš„ `åˆ›å»ºæµæ°´çº¿`
   - åˆ›å»ºæ¨¡æ¿é€‰æ‹© `å…¶ä»–Â·ç©ºæ¨¡æ¿`
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mbj74qhtj31hc0swn83.jpg)
   - ç„¶åä¼šè‡ªåŠ¨å¼¹å‡º `æµæ°´çº¿æº`ï¼Œç„¶åæŒ‰ç…§å›¾ç¤ºè¿›è¡Œè®¾ç½®
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mbkf4l59j31hc0swwm2.jpg)
   - ç„¶åé€‰æ‹© `é˜¶æ®µ1` ä¸­çš„ `ç©ºä»»åŠ¡`
   - åœ¨å³ä¾§å¼¹å‡ºé¢æ¿ä¸­ï¼Œå°†ä»»åŠ¡åä¿®æ”¹ä¸º `ç­¾åˆ°æ‰“å¡`
   - ç‚¹å‡»å³ä¾§é¢æ¿ä¸­ä¸‹ä¾§çš„ `æ·»åŠ æ­¥éª¤`ï¼Œé€‰æ‹© `æ„å»º->Node.jsæ„å»º`
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mbnyix7qj31hc0swjz1.jpg)
   - ç°åœ¨ä½ çš„ç•Œé¢åº”è¯¥æ˜¯è¿™æ ·çš„
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mboqhzt7j30dw0nhdho.jpg)
   - `ç‰ˆæœ¬é€‰æ‹©æ–¹å¼` ä¿®æ”¹ä¸º `è¾“å…¥æŒ‡å®šç‰ˆæœ¬`
   - `è¯·å¡«å†™ Node ç‰ˆæœ¬` ä¿®æ”¹ä¸º `16`
   - `æ„å»ºå‘½ä»¤` å¡«å†™ä¸ºå¦‚ä¸‹
    ```shell
    npm ci
    npm run build
    npm run start
    ```
   - æ­¤åˆ»ä½ çš„ç•Œé¢åº”è¯¥æ˜¯è¿™æ ·
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mfbszcb3j31hc0swahi.jpg)
5. é…ç½®é‚®ä»¶é€šçŸ¥
   - åœ¨åˆšæ‰æ­¥éª¤çš„åŸºç¡€ä¹‹ä¸Šï¼Œå†é€‰æ‹© `æ·»åŠ æ’ä»¶` -> `é‚®ä»¶é€šçŸ¥`
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mfdotwqsj30fc0kitak.jpg)
   - å®Œæˆä¹‹åï¼Œä½ çš„ç•Œé¢åº”è¯¥æ˜¯è¿™æ ·çš„
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mftnxhxtj30e10aqdgb.jpg)
6. é…ç½®å®šæ—¶ä»»åŠ¡
   - æ¥ç€é…ç½®å®šæ—¶è§¦å‘è¯¥æµæ°´çº¿
   - ç‚¹å‡»é¡¶éƒ¨çš„ `è§¦å‘è®¾ç½®`
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mfficotyj30wu0aw75c.jpg)
   - æŒ‰ç…§ä¸‹å›¾è¿›è¡Œé…ç½®å³å¯
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mfg11cjnj30t50etq4d.jpg)
7. ä¿®æ”¹æµæ°´çº¿åç§°ï¼ˆå¯é€‰ï¼‰
   - ç‚¹å‡»é¡¶éƒ¨çš„ `åŸºæœ¬ä¿¡æ¯`
   - åœ¨ `æµæ°´çº¿ä¿¡æ¯` ä¸­ï¼Œå°† `æµæ°´çº¿åç§°` ä¿®æ”¹ä¸º `æ˜“ç­ç­¾åˆ°æ‰“å¡`ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mfi65d1oj31440kp0u6.jpg)
8. ä¿å­˜æµæ°´çº¿ï¼Œç‚¹å‡»æœ€å³ä¸Šè§’çš„ `ä»…ä¿å­˜` æŒ‰é’®
9. é…ç½®ç­¾åˆ°è´¦å·ä¿¡æ¯
   - å›åˆ° `codeup` ä»£ç ç®¡ç†ç•Œé¢ï¼Œå¦‚æœæ‰¾ä¸åˆ°å¯ä»¥ç‚¹å‡»æœ€å·¦ä¸Šè§’çš„ä¹ä¸ªç‚¹ï¼Œæ‰“å¼€ `ç ”å‘->ä»£ç ç®¡ç†` å°±èƒ½æ‰¾åˆ°ä»“åº“äº†
   - é€‰ä¸­ `.env` æ–‡ä»¶ï¼Œå†ç‚¹å‡»å³ä¾§çš„ç¼–è¾‘æŒ‰é’®
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mfli0ey1j31hc0swtjp.jpg)
   - å¡«å†™ä½ è‡ªå·±çš„ç­¾åˆ°ä¿¡æ¯ä¹‹åç‚¹å‡»ä¿å­˜å³å¯ï¼ˆå¦‚æœä½ çš„æ˜¯JSONæ ¼å¼ï¼Œé‚£ä¹ˆæœ€å¤–å±‚å°±åº”è¯¥ç”¨å•å¼•å·ã€‚æˆ‘è¿™é‡Œæ˜¯ä½¿ç”¨çš„JSON5ï¼Œé‡Œé¢çš„å†…å®¹éƒ½æ˜¯å•å¼•å·ï¼Œæ‰€ä»¥æœ€å¤–å±‚ç”¨çš„æ˜¯åŒå¼•å·ï¼‰
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mfngepjoj30qf0o478y.jpg)
   - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mfnwxftqj30i509nt9w.jpg)
10. è¿è¡Œæµæ°´çº¿è¿›è¡Œæµ‹è¯•
    - ç°åœ¨å›åˆ°æµæ°´çº¿ï¼Œæµ‹è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·‘çš„é€š
    - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mfp9c9roj31hc0sw44m.jpg)
    - è¿›å…¥æ—¥å¿—ï¼ŒæŸ¥çœ‹è¿è¡Œæƒ…å†µ
    - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mfpuzmayj30lf0bt3zf.jpg)
    - åœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼Œåœ¨å·¦ä¾§çš„ `æ„å»º` é€‰æ‹© `Node.js æ„å»º`ï¼Œç„¶åæ‹‰åˆ°æœ€åº•ä¸‹ï¼Œæ­¤æ—¶åº”è¯¥å¯ä»¥çœ‹åˆ°æç¤ºä¿¡æ¯
    - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mfra84eij31hc0swamm.jpg)
11. è‡³æ­¤æ“ä½œå·²ç»å…¨éƒ¨å®Œæˆï¼Œç¬¬äºŒå¤©ä¼šæŒ‰ç…§é¢„è®¾çš„æ—¶é—´è¿›è¡Œæ‰“å¡ï¼Œè¿è¡Œç»“æœä¼šè¿›è¡Œé‚®ä»¶é€šçŸ¥
12. é‚®ä»¶é€šçŸ¥å¤§æ¦‚é•¿è¿™æ ·
    - ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mg0ey3u5j30oc0hlgmv.jpg)


## æ•°æ®æ ¼å¼

ç­¾åˆ°JSONæ•°æ®çš„Schemaè¯·å‚é˜…ï¼š[schema.json](./dcos/schema.json)

ç­¾åˆ°æ•°æ®ç¤ºä¾‹ï¼š
```json5
[
  // æ¯ä¸€ä¸ªå¯¹è±¡å°±æ˜¯ä¸€ä¸ªç­¾åˆ°è´¦å·
  {
    "account": {
      // è´¦å·ï¼Œè¿™é‡Œçš„è´¦å·å¯†ç æ˜¯http://xggl.hnie.edu.cn/è¿™ä¸ªç½‘ç«™çš„
      "account": "demo",
      // å¯†ç ï¼Œé»˜è®¤æ˜¯Hnie@èº«ä»½è¯åå…­ä½
      "password": "Hnie@demo"
    },
    "signFormData": {
      // ç­¾åˆ°æ‰€åœ¨åœ°ï¼ˆåœ°å›¾apiå®šä½ç»“æœï¼‰
      "address": "æ¹–å—çœéƒ´å·å¸‚åŒ—æ¹–åŒºäº”å²­å¤§é“9å·",
      // ç­¾åˆ°æ‰€åœ¨åœ°ç»çº¬åº¦
      "position": "113.014999,25.7706",
      // ç­¾åˆ°åœ°å€ï¼ˆç²¾ç¡®çš„å¿çº§ï¼‰
      "signAddress": "æ¹–å—çœéƒ´å·å¸‚",
      // çœä¼šé‚®ç¼–
      "provinceZipCode": "430000",
      // å¸‚ä¸­å¿ƒé‚®ç¼–
      "cityZipCode": "431000",
      // å¿ä¸­å¿ƒé‚®ç¼–
      "countyZipCode": "431081",
      // ç°å±…åœ°è¯¦ç»†åœ°å€
      "habitationDetailDesc": "æ¹–å—çœéƒ´å·èµ„å…´å¸‚é²¤é±¼æ±ŸKFC",
      // å¸¸ä½åœ°è¯¦ç»†åœ°å€
      "usualResidenceDetailDesc": "æ¹–å—çœéƒ´å·èµ„å…´å¸‚é²¤é±¼æ±ŸKFC",
      // æ‰‹æœºå·
      "phone": "15971115555"
    }
  },
  {
    "account": {
      "account": "demo",
      "password": "Hnie@demo"
    },
    "signFormData": {
      "address": "æ¹–å—çœéƒ´å·å¸‚åŒ—æ¹–åŒºäº”å²­å¤§é“9å·",
      "position": "113.014999,25.7706",
      "signAddress": "æ¹–å—çœéƒ´å·å¸‚",
      "provinceZipCode": "430000",
      "cityZipCode": "431000",
      "countyZipCode": "431081",
      "habitationDetailDesc": "æ¹–å—çœéƒ´å·èµ„å…´å¸‚é²¤é±¼æ±ŸKFC",
      "usualResidenceDetailDesc": "æ¹–å—çœéƒ´å·èµ„å…´å¸‚é²¤é±¼æ±ŸKFC",
      "phone": "15971115555"
    }
  }
]
```

## éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®

è¯·ä½¿ç”¨ [Json Schema Validator](https://www.jsonschemavalidator.net/)ï¼Œå·¦è¾¹å¡«å†™[schema.json](./dcos/schema.json)ä¸­çš„å†…å®¹ï¼Œå³è¾¹å¡«å†™ä½ çš„é…ç½®

ç¤ºä¾‹ï¼š
![img](https://tva1.sinaimg.cn/large/008d89Swgy1h5lsymyxakj31hc0m1gvf.jpg)

## æ³¨æ„
æµ·å¤–ipå¥½åƒæ— æ³•ç­¾åˆ°ï¼Œæ‰“å¼€é¡µé¢ä¼šæ˜¾ç¤º `502`

è¿”å›æ•°æ®é•¿è¿™æ ·
```text
***31m    data: '<html>\r\n' +***39m
***31m      '<head><title>502 Bad Gateway</title></head>\r\n' +***39m
***31m      '<body bgcolor="white">\r\n' +***39m
***31m      '<center><h1>Notice:502 Bad Gateway</h1></center>\r\n' +***39m
***31m      '<!-- a padding to disable MSIE and Chrome friendly error page -->\r\n' +***39m
***31m      '<!-- a padding to disable MSIE and Chrome friendly error page -->\r\n' +***39m
***31m      '<!-- a padding to disable MSIE and Chrome friendly error page -->\r\n' +***39m
***31m      '<!-- a padding to disable MSIE and Chrome friendly error page -->\r\n' +***39m
***31m      '<!-- a padding to disable MSIE and Chrome friendly error page -->\r\n' +***39m
***31m      '<!-- a padding to disable MSIE and Chrome friendly error page -->\r\n'***39m
```
## å¸¸è§é—®é¢˜

### 1. é…ç½®å†™åœ¨.envä¸­ä¸ä¼šæ³„éœ²å—
> å¦‚æœä½ å¼€æ”¾äº†æƒé™ç»™åˆ«äººçœ‹äº†è¯æ˜¯æœ‰å¯èƒ½ä¼šæ³„éœ²çš„ã€‚
>
> å› æ­¤æˆ‘ä¹Ÿæä¾›äº†ç¬¬äºŒç§é…ç½®çš„æ–¹å¼ï¼š
>
> å°†é…ç½®ä¿¡æ¯å†™è¿›ç¯å¢ƒå˜é‡ä¸­ï¼Œæ•ˆæœå¦‚ä¸‹
>
> ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mghnvtv6j31hc0swdod.jpg)
>
> åªå¯æƒœçš„æ˜¯äº‘æ•ˆè¿™é‡Œä¸èƒ½ç›´æ¥å†™ä¸€ä¸ªJSONè¿›å»ï¼Œéœ€è¦base64ç¼–ç ä¸€ä¸‹æ‰èƒ½å†™å…¥è¿›å»ã€‚
>
> æ­¥éª¤å¦‚ä¸‹ï¼š
>
> 1. éšä¾¿æ‰¾ä¸€ä¸ªåœ¨çº¿base64çš„ç½‘ç«™ï¼Œä¾‹å¦‚ï¼šhttps://base64.us/
> 2. æŠŠä½ çš„é…ç½®è¾“å…¥è¿›å»ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º
> 3. ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mglkcly2j31hc0swn6l.jpg)
> 4. ç„¶åå¤åˆ¶ç¼–ç ä¹‹åçš„å€¼
> 5. å›åˆ°äº‘æ•ˆï¼Œç‚¹å¼€ä¹‹å‰åˆ›å»ºçš„æµæ°´çº¿ï¼Œç‚¹å‡»é¡¶éƒ¨çš„ `å˜é‡å’Œç¼“å­˜`ï¼Œåœ¨ `å­—ç¬¦å˜é‡` å³ä¾§ç‚¹å‡» `æ–°å»ºå˜é‡`
> 6. ç„¶åæŒ‰ç…§ä¸‹å›¾ç¤ºä¾‹è¿›è¡Œå¡«å†™ï¼Œå˜é‡åæ˜¯ `SIGN_CONFIG_BASE64`
> 7. ![](https://tva1.sinaimg.cn/large/008d89Swgy1h5mgo1jzphj31hc0swqar.jpg)
> 8. æ·»åŠ ä¹‹åå†ç‚¹å‡»å³ä¸Šè§’çš„ `ä»…ä¿å­˜` å³å¯
> 9. ç„¶åä½ é€€å‡ºé‡è¿›ï¼Œä¼šå‘ç°è¿™ä¸ªå˜é‡åªèƒ½è¢«æ›¿æ¢ï¼Œä¸èƒ½è¢«è¯»å–äº†
>
> **æç¤º**ï¼šç¯å¢ƒå˜é‡çš„ä¼˜å…ˆçº§æ˜¯æœ€é«˜çš„ã€‚
>
> å¦‚æœåŒæ—¶è®¾ç½® `.env` `.env.local` `ç¯å¢ƒå˜é‡`
>
> å…¶ä¸­çš„ä¼˜å…ˆçº§æ˜¯ï¼š`ç¯å¢ƒå˜é‡` > `.env.local` > `.env`
